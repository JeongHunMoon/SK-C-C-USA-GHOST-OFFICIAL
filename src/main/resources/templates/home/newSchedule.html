<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge"> <!-- HTML 파일 문서 호환성을 edge버전으로 통일-->
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/> <!-- HTML 4.0.1 버전 기준 문자인코딩 방식 정의 -->
    <!-- 현재 사용자가 접속한 디바이스의 가로 세로 길이에 맞게 앱 사이즈를 조절함. 초기, 최대, 최소 비율은 모두 1이며, 사용자가 드레그로 크기 조정 불가능-->
    <meta name="viewport" content="width=device-width, height=device-height, initial-scale=1.0, maximum-scale=1.0, minimum-scale = 1.0, user-scalable=no">

    <!-- CSS 정의 -->
    <link rel = "stylesheet" href = "css/init.css">
    <link rel = "stylesheet" href = "css/admin/newAdmin.css">

    <!-- 카카오 API를 사용하기 위한 라이브러리 선언-->
    <script type="text/JavaScript" src="https://developers.kakao.com/sdk/js/kakao.min.js"></script>
    <script> Kakao.init('2e39201190179fe7cd5eb25903daba8a'); </script> <!--SDK를 초기화 (애플리케이션>앱설정>앱키:JAVASCRIPTKEY -->

    <!-- 자바스크립트 함수 정의 -->
    <script src = "../../JavaScript/unlinkWithKakao.js"></script>
    <script src = "../../JavaScript/loginAram.js"></script>
    <script src = "../../JavaScript/loadingOn.js"></script>
    <script src = "../../JavaScript/loadingOff.js"></script>
    <script src = "../../JavaScript/createScheduleCard.js"></script>
    <script src = "../../JavaScript/createCardStored.js"></script>

    <title>New Admin</title>

</head>
<script>
</script>

<body id = "body">
<!-- 메인 해더-->
<header id = "header">
    <img id = "header_sk" src="css/images/Ghost.png" alt = "location images"> <!-- GHOST 트레이드 마크 -->
    <span id = "header_logo">New Admin</span> <!-- GHOST text -->
</header>

<section id = "section_date">
    <h1 id="slider-value">1</h1>
    <form id = "dateForm">
        <input type="submit" id = "date_submit" value="Submit">
    </form>
</section>
<!-- 전체 seciton은 top과 bottom으로 구성된다.-->
<section id="section_top">
    <div id="image-container">

    </div>
</section>

<!-- 메인 푸터  -->
<footer id = "footer">
    <input type="range" id="slider" name="slider" min="1" max="7" value="1" step="1" oninput="updateValue()">
</footer>
</body>

<!-- 카드 마우스 흴 이벤트 -->
<script>
    const Container = document.getElementById("image-container");
    document.addEventListener('DOMContentLoaded', function () {
        let container = document.getElementById('image-container');

        container.addEventListener('wheel', function (e) {
            container.scrollLeft += e.deltaY;
            e.preventDefault();
        });
    });
</script>

<!-- 처음 페이지가 실행되면 DB에서 가장 마지막 날짜 + 1 날짜를 가져옴 + default 1개 출력  -->
<script>
    let date = "2024-02-25";

    let newYorkTimeZone = "America/New_York";

    // 주어진 날짜를 Date 객체로 변환하고 뉴욕 시간으로 설정
    let dateInNewYork = new Date(date + "T00:00:00");
    dateInNewYork.toLocaleString("en-US", { timeZone: newYorkTimeZone });

    // 날짜의 요일을 가져오기
    let dayOfWeek = dateInNewYork.toLocaleDateString("en-US", { weekday: "long" });
    Container.appendChild(createCardStored([], dayOfWeek, date))

</script>

<!-- 처음 페이지가 실행되면 DB에서 가장 마지막 날짜 + 1 날짜를 가져옴 + default 1개 출력  -->
<script>
    let cardInfo = []

    let startDate = new Date(date);
    let endDate = new Date(startDate);
    endDate.setDate(startDate.getDate() + 6);

    let dateArray = [];

    // 현재 컨테이너 안에 모든 카드 지우기.
    while (startDate <= endDate) {
        let formattedDate = startDate.toISOString().split('T')[0];
        dateArray.push(formattedDate);
        startDate.setDate(startDate.getDate() + 1);
    }

    // DB에서 조회된 날짜 + 7일 정보 저장.
    for(let dateVal of dateArray) {
        console.log(dateVal)
        let newYorkTimeZone = "America/New_York";

        // 주어진 날짜를 Date 객체로 변환하고 뉴욕 시간으로 설정
        let dateInNewYork = new Date(dateVal + "T00:00:00");
        dateInNewYork.toLocaleString("en-US", { timeZone: newYorkTimeZone });

        // 날짜의 요일을 가져오기
        let dayOfWeek = dateInNewYork.toLocaleDateString("en-US", { weekday: "long" });
        cardInfo.push(createCardStored([], dayOfWeek, dateVal))
    }
    console.log(cardInfo)

    // JavaScript 코드
    function updateValue() {
        const slider = document.getElementById('slider');
        const sliderValue = document.getElementById('slider-value');
        const value = slider.value;

        sliderValue.textContent = value;

        //다 지우기.
        let imageContainer = document.getElementById("image-container");

        while (imageContainer.firstChild) {
            imageContainer.removeChild(imageContainer.firstChild);
        }

        // 다 찍기.
        for(let i = 0; i < value; i++) {
            Container.appendChild(cardInfo[i])
        }
    }
</script>

<script>
    const dateForm = document.getElementById('dateForm');

    // submit 이벤트가 발생하면 실행되는 함수
    dateForm.addEventListener('submit', function(event) {
        // 폼의 기본 동작을 막음 (페이지 새로고침 방지)
        event.preventDefault();
        let num = document.getElementById('slider-value');

        // 슬라이더랑, submit숨기고, 5일치를 입력하세요 문구 띄우기
    })
</script>
</html>