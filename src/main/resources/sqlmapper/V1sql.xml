<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "https://mybatis.org/dtd/mybatis-3-mapper.dtd">


<mapper namespace="GHOST.sk_ghost.dao.V1Dao">

    <!-- 전체 사용자 조회 -->
    <select id="userList" resultType="map">
        select * from user_info
    </select>

    <!-- 금일 담당 운영 대응자 조회 -->
    <select id="shiftAdminList" resultType="map">
        SELECT CAST(es.id AS CHAR) AS id, es.name, CAST(es.date AS CHAR) AS date, es.shift, f.uuid, CAST(es.priority AS CHAR) AS priority, CAST(ui.process AS CHAR) AS process
        FROM elec_shift es
        INNER JOIN friend f ON es.id = f.id
        LEFT JOIN user_info ui ON es.id = ui.id  -- 추가: user_info 테이블과의 조인
        WHERE es.priority IN (1, 2) AND (DATE_FORMAT(CURDATE(), "%Y-%m-%d") = DATE_FORMAT(es.date, "%Y-%m-%d"))
        ORDER BY es.priority;

    </select>
</mapper>

